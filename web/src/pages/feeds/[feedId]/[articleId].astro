import { GLOBAL } from "../../../lib/variables";
import Layout from "../../../layouts/Layout.astro";
import ArticleItem from "../../../components/articles/ArticleItem.astro";
import Section from "../../../components/common/Section.astro";
import { sampleArticles } from "../../../lib/samples/articles";
import { sampleFeeds } from "../../../lib/samples/feeds";

const { feedId, articleId } = Astro.params;

// This will be replaced with actual API calls when backend is ready
const feed = sampleFeeds.find(f => f.id === feedId);
const article = sampleArticles.find(a => a.id === articleId && a.feedId === feedId);

<Layout>
  <Fragment slot="head">
    <title>{GLOBAL.username} â€¢ {article?.title || 'Article'}</title>
    <meta
      name="description"
      content={article?.description || GLOBAL.projectLongDescription}
    />
  </Fragment>
  <Section>
    <div class="flex flex-col gap-8">
      {article ? (
        <ArticleItem article={article} showContent={true} />
      ) : (
        <div class="text-center py-12">
          <p class="text-gray-600 dark:text-gray-400">Article not found.</p>
        </div>
      )}
    </div>
  </Section>
</Layout>

<script>
  // This will be implemented when the backend is ready
  async function fetchArticle() {
    try {
      // const response = await fetch(`/api/feeds/${feedId}/articles/${articleId}`);
      // if (!response.ok) {
      //   throw new Error('Failed to fetch article');
      // }
      // const data = await response.json();
      // TODO: Update the UI with the fetched article
      console.log('Fetching article...');
    } catch (error) {
      console.error('Error fetching article:', error);
    }
  }

  // Fetch article when the page loads
  document.addEventListener('DOMContentLoaded', fetchArticle);
</script> 